<div class="container-list">
  <div class="site-page-header-ghost-wrapper">
    <nz-page-header nzBackIcon [nzTitle]="title" class="site-page-header">
      <nz-page-header-extra>
        <nz-space [nzWrap]="true" class="gap-[5px]">

          <button class="!flex !items-center" nzType="default" nz-button (click)="getDataHeader()"
            [appPermission]="CALCULATE_RESULT_RIGHT.UPDATE">
            <span nz-icon nzType="right-square"></span> Dữ liệu đầu vào
          </button>
          <button class="!flex !items-center" nzType="default" nz-button (click)="reCalculate()">
            <span nz-icon nzType="calculator"></span> Tính toán lại
          </button>
          <button class="!flex !items-center" nzType="default" nz-button (click)="changeStatus('01', '02')"
            [appPermission]="CALCULATE_RESULT_RIGHT.TRINH_DUYET"
            *ngIf="model.header.status == '01' || model.header.status == '03'">
            <span nz-icon nzType="send"></span> Trình duyệt
          </button>
          <button class="!flex !items-center" nzType="default" nz-button (click)="changeStatus('02', '03')"
            [appPermission]="CALCULATE_RESULT_RIGHT.YEU_CAU_CHINH_SUA" *ngIf="model.header.status == '02'">
            <span nz-icon nzType="undo"></span> Yêu cầu chỉnh sửa
          </button>
          <button class="!flex !items-center" nzType="default" nz-button (click)="changeStatus('03', '04')"
            [appPermission]="CALCULATE_RESULT_RIGHT.PHE_DUYET" *ngIf="model.header.status == '02'">
            <span nz-icon nzType="check"></span> Phê duyệt
          </button>
          <button class="!flex !items-center" nzType="default" nz-button (click)="changeStatus('04', '05')"
            [appPermission]="CALCULATE_RESULT_RIGHT.TU_CHOI" *ngIf="model.header.status == '02'">
            <span nz-icon nzType="close"></span> Từ chối
          </button>
          <button class="!flex !items-center" nzType="default" nz-button (click)="showHistoryAction()"
            [appPermission]="CALCULATE_RESULT_RIGHT.HISTORY">
            <span nz-icon nzType="history"></span> Lịch sử thực hiện
          </button>
          <button class="!flex !items-center" nzType="default" nz-button (click)="showHistoryExport()"
            [appPermission]="CALCULATE_RESULT_RIGHT.HISTORY">
            <span nz-icon nzType="history"></span> Lịch sử xuất file
          </button>
          <button class="!flex !items-center btn-excel" nzType="primary" nz-button (click)="exportExcel()"
            [appPermission]="CALCULATE_RESULT_RIGHT.EXCEL">
            <span nz-icon nzType="file-excel"></span> Xuất Excel
          </button>
          <button class="!flex !items-center" nzType="primary" nz-button (click)="exportWord()"
            [appPermission]="CALCULATE_RESULT_RIGHT.EXCEL">
            <span nz-icon nzType="file-word"></span> Xuất Word
          </button>
          <button class="!flex !items-center btn-pdf" nzType="primary" nz-button (click)="exportPDF()"
            [appPermission]="CALCULATE_RESULT_RIGHT.EXCEL">
            <span nz-icon nzType="file-pdf"></span> Xuất PDF
          </button>
          <button nz-popconfirm class="!flex !items-center btn-sms" nzType="primary"
            nzPopconfirmTitle="Bạn có chắc chắn gửi SMS thông báo cho các khách hàng?" (nzOnConfirm)="confirmSendSMS()"
            [nzCancelText]="'Huỷ'" [nzOkText]="'Gửi'" (nzOnCancel)="cancelSendSMS()" nzPopconfirmPlacement="bottom"
            nz-button>
            <span nz-icon nzType="message"></span> Gửi SMS
          </button>
          <button nz-popconfirm class="!flex !items-center btn-email" nzType="primary"
            nzPopconfirmTitle="Bạn có chắc chắn gửi Email thông báo cho các khách hàng?"
            (nzOnConfirm)="confirmSendSMS()" [nzCancelText]="'Huỷ'" [nzOkText]="'Gửi'" (nzOnCancel)="cancelSendSMS()"
            nzPopconfirmPlacement="bottom" nz-button>
            <span nz-icon nzType="mail"></span> Gửi Email
          </button>
          <button nz-button nzType="default" (click)="fullScreen()"><span nz-icon nzType="fullscreen"></span></button>
        </nz-space>
      </nz-page-header-extra>
    </nz-page-header>
  </div>

<div [ngClass]="isZoom ? 'zoom' : ''">
  <button nz-button [ngClass]="isZoom ? 'd-block close' : 'd-none'" nzType="default" (click)="closeFullScreen()"><span nz-icon nzType="fullscreen-exit"></span></button>
  <nz-tabset>
    <nz-tab nzTitle="Dữ liệu gốc" (nzClick)="changeTitle('DỮ LIỆU GỐC')">
      <div
      [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <div nz-row [nzGutter]="16">
          <div nz-col class="gutter-row" [nzSpan]="17">
            <div class="inner-box">
              <nz-divider nzText="1. Thị trường thành phố Vinh, TX Cửa Lò" nzOrientation="left"></nz-divider>
              <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #dlgTable_1
                [nzData]="data.dlg.dlg_1">
                <thead>
                  <tr>
                    <th class="align-center" rowspan="2">MẶT HÀNG</th>
                    <th class="align-center" rowspan="2">GIÁ BÁN LẺ CƠ SỞ <br> (Giá vùng 1 TĐ công
                      bố)</th>
                    <th class="align-center" rowspan="2">GIÁ BÁN LẺ VÙNG 2 <br> (TĐ công bố)</th>
                    <th class="align-center" rowspan="2">CHỆNH LỆCH <br> GIÁ V2-V1</th>
                    <th class="align-center" colspan="2">ĐỀ XUẤT GIÁ BÁN LẺ <br> VÙNG TT TRUNG TÂM
                    </th>
                    <th class="align-center" rowspan="2">CHÊNH LỆCH GIÁ BÁN LẺ <br> VÙNG TT VÀ CÒN
                      LẠI</th>
                    <th class="align-center" rowspan="2">ĐÁNH GIÁ</th>
                  </tr>
                  <tr>
                    <th class="align-center">Mức tăng so VÙNG 1</th>
                    <th class="align-center">Giá niêm yết</th>
                  </tr>
                </thead>
                <tbody>
                  @for (d of dlgTable_1.data; track d) {
                  <tr>
                    <td>{{d.col1}}</td>
                    <td class="align-right">{{d.col2 | number}}</td>
                    <td class="align-right">{{d.col3 | number}}</td>
                    <td class="align-right">{{d.col4 | number}}</td>
                    <td class="align-right">{{d.col5 | number}}</td>
                    <td class="align-right">{{d.col6 | number}}</td>
                    <td class="align-right">{{d.col7 | number}}</td>
                    <td></td>
                  </tr>
                  }
                </tbody>
              </nz-table>
            </div>
          </div>
          <div nz-col class="gutter-row" [nzSpan]="7">
            <div class="inner-box">
              <nz-divider nzText="2. Các huyện thị còn lại trên địa bàn Nghệ An + Hà Tĩnh"
                nzOrientation="left"></nz-divider>
              <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #dlgTable_2
                [nzData]="data.dlg.dlg_2">
                <thead>
                  <tr>
                    <th class="align-center">MẶT HÀNG</th>
                    <th class="align-center">GIÁ BÁN LẺ <br>(Bằng giá bán lẻ vùng 2 TĐ
                      công bố)</th>
                  </tr>
                </thead>
                <tbody>
                  @for (d of dlgTable_2.data; track d) {
                  <tr>
                    <td>{{d.col1}}</td>
                    <td class="align-right">{{d.col2 | number}}</td>
                  </tr>
                  }
                </tbody>
              </nz-table>
            </div>
          </div>
        </div>

        <nz-divider nzText="BIỂU TỔNG HỢP CÁC CHỈ TIÊU DẦU SÁNG (PT bán lẻ - V2)" nzOrientation="left"></nz-divider>
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #dlgTable_3
          [nzData]="data.dlg.dlg_3">
          <thead>
            <tr>
              <th rowSpan="2" class="align-center">STT</th>
              <th rowSpan="2" class="align-center">LOẠI HÀNG</th>
              <th rowSpan="2" class="align-center">H.SỐ VCF <br> BQ MÙA <br> MIỀN</th>
              <th rowSpan="2" class="align-center">THUẾ <br> BVMT</th>
              <th colSpan="3" class="align-center">GIÁ BÁN NỘI BỘ TẬP ĐOÀN</th>
              <th rowSpan="2" class="align-center">GIÁ BÁN LẺ <br> CƠ SỞ (VÙNG 1) <br> CÓ VAT &BVMT</th>
              <th colSpan="2" class="align-center">GIÁ BÁN LẺ VÙNG 2</th>
              <th colSpan="2" class="align-center">LÃI GỘP (Đ/LTT)</th>
            </tr>
            <tr>
              <th class="align-center">L15 CHƯA VAT <br> & BVMT</th>
              <th class="align-center">LTT CHƯA VAT <br> & BVMT</th>
              <th class="align-center">LTT CÓ VAT <br> & BVMT</th>
              <th class="align-center">GIÁ CÔNG BỐ</th>
              <th class="align-center">CHƯA VAT & BVMT</th>
              <th class="align-center">CÓ VAT & BVMT</th>
              <th class="align-center">CHƯA VAT & BVMT</th>
            </tr>
          </thead>
          <tbody>
            @for (d of dlgTable_3.data; track d) {
            <tr>
              <td>{{d.colA}}</td>
              <td>{{d.colB}}</td>
              <td class="align-right">{{d.col1 | number}}</td>
              <td class="align-right">{{d.col2 | number}}</td>
              <td class="align-right">{{d.col3 | number}}</td>
              <td class="align-right">{{d.col4 | number}}</td>
              <td class="align-right">{{d.col5 | number}}</td>
              <td class="align-right">{{d.col6 | number}}</td>
              <td class="align-right">{{d.col7 | number}}</td>
              <td class="align-right">{{d.col8 | number}}</td>
              <td class="align-right">{{d.col9 | number}}</td>
              <td class="align-right">{{d.col10 | number}}</td>
            </tr>
            }
          </tbody>
        </nz-table>

        <nz-divider nzText="BIỂU TỔNG HỢP CÁC CHỈ TIÊU DẦU SÁNG (ngoài bán lẻ)" nzOrientation="left"></nz-divider>
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #dlgTable_4
          [nzData]="data.dlg.dlg_4">
          <thead>
            <tr>
              <th rowSpan="2" class="align-center">STT</th>
              <th rowSpan="2" class="align-center">LOẠI HÀNG</th>
              <th rowSpan="2" class="align-center">H.SỐ VCF <br> BQ MÙA <br> MIỀN</th>
              <th rowSpan="2" class="align-center">THUẾ <br> BVMT</th>
              <th colSpan="3" class="align-center">GIÁ BÁN NỘI BỘ TẬP ĐOÀN</th>
              <th colSpan="2" class="align-center">GIÁ BÁN LẺ <br> (Lít tt)</th>
              <th colSpan="2" class="align-center">LÃI GỘP THEO <br> GIÁ TĐ GIAO (Lít tt)</th>
              <th colSpan="2" class="align-center">LÃI GỘP ĐIỀU TIẾT</th>
              <th colSpan="2" class="align-center">LÃI GỘP LINH HOẠT <br> (Đ/Lít tt)</th>
              <th rowSpan="2" class="align-center">GIẢM GIÁ <br> FOB CÓ VAT <br> & BVMT</th>
              <th rowSpan="2" class="align-center">LỢI NHUẬN <br> CÓ THUẾ L15</th>
              <th rowSpan="2" class="align-center">LỢI NHUẬN <br> CÓ THUẾ Ltt</th>
            </tr>
            <tr>
              <th class="align-center">L15 CHƯA VAT <br> & BVMT</th>
              <th class="align-center">LTT CHƯA VAT <br> & BVMT</th>
              <th class="align-center">LTT CÓ VAT <br> & BVMT</th>
              <th class="align-center">GIÁ NIÊM YẾT</th>
              <th class="align-center">CHƯA VAT <br> & BVMT</th>
              <th class="align-center">CÓ VAT <br> & BVMT</th>
              <th class="align-center">CHƯA VAT <br> & BVMT</th>
              <th class="align-center">L15 CHƯA VAT <br> & BVMT</th>
              <th class="align-center">LTT CÓ VAT <br> & BVMT</th>
              <th class="align-center">CÓ VAT <br> & BVMT</th>
              <th class="align-center">CHƯA VAT <br> & BVMT</th>
            </tr>
          </thead>
          <tbody>
            @for (d of dlgTable_4.data; track d) {
            <tr *ngIf="d.isBold" style="font-weight: bold;">
              <td>{{d.colA}}</td>
              <td>{{d.colB}}</td>
              <td colspan="16"></td>
            </tr>
            <tr *ngIf="!d.isBold">
              <td>{{d.colA}}</td>
              <td>{{d.colB}}</td>
              <td class="align-right">{{d.col1 | number}}</td>
              <td class="align-right">{{d.col2| number}}</td>
              <td class="align-right">{{d.col3| number}}</td>
              <td class="align-right">{{d.col4| number}}</td>
              <td class="align-right">{{d.col5| number}}</td>
              <td class="align-right">{{d.col6| number}}</td>
              <td class="align-right">{{d.col7| number}}</td>
              <td class="align-right">{{d.col8| number}}</td>
              <td class="align-right">{{d.col9| number}}</td>
              <td class="align-right">{{d.col10| number}}</td>
              <td class="align-right">{{d.col11| number}}</td>
              <td class="align-right">{{d.col12| number}}</td>
              <td class="align-right">{{d.col13| number}}</td>
              <td class="align-right">{{d.col14| number}}</td>
              <td class="align-right">{{d.col15| number}}</td>
              <td class="align-right">{{d.col16| number}}</td>
            </tr>
            }
          </tbody>
        </nz-table>
        <nz-divider nzText="BIỂU TÍNH GIÁ XUẤT NỘI DỤNG" nzOrientation="left"></nz-divider>
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #dlgTable_5
          [nzData]="data.dlg.dlg_5">
          <thead>
            <tr>
              <th rowSpan="2" class="align-center">STT</th>
              <th rowSpan="2" class="align-center">LOẠI HÀNG</th>
              <th rowSpan="2" class="align-center">H.SỐ VCF <br> BQ MÙA <br> MIỀN</th>
              <th rowSpan="2" class="align-center">THUẾ <br> BVMT</th>
              <th colSpan="2" class="align-center">GIÁ BÁN NỘI BỘ TĐ</th>
              <th rowSpan="2" class="align-center">GIA XUẤT NỘI DỤNG <br> (Bao gồm VAT&BVMT)</th>
            </tr>
            <tr>
              <th class="align-center">L15 CHƯA THUẾ <br> VAT & BVMT</th>
              <th class="align-center">LTT CHƯA THUẾ <br> VAT & BVMT</th>
            </tr>
          </thead>
          <tbody>
            @for (d of dlgTable_5.data; track d) {
            <tr>
              <td>{{d.colA}}</td>
              <td>{{d.colB}}</td>
              <td class="align-right">{{d.col1 | number}}</td>
              <td class="align-right">{{d.col2 | number}}</td>
              <td class="align-right">{{d.col3 | number}}</td>
              <td class="align-right">{{d.col4 | number}}</td>
              <td class="align-right">{{d.col5 | number}}</td>
            </tr>
            }
          </tbody>
        </nz-table>



        <nz-divider nzText="BIỂU TÍNH GIÁ BÁN CHO CÔNG TY CP VẬN TẢI VÀ DỊCH VỤ PETROLIMEX NGHỆ TĨNH"
          nzOrientation="left"></nz-divider>
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #dlgTable_6
          [nzData]="data.dlg.dlg_6">
          <thead>
            <tr>
              <th rowSpan="2" class="align-center">STT</th>
              <th rowSpan="2" class="align-center">LOẠI HÀNG</th>
              <th rowSpan="2" class="align-center">H.SỐ VCF <br> BQ MÙA <br> MIỀN</th>
              <th colSpan="2" class="align-center">THUẾ BVMT</th>
              <th rowSpan="2" class="align-center">GIÁ BÁN NỘI BỘ <br> TĐ L15 CHƯA THUẾ <br> VAT & BVMT
              </th>
              <th rowSpan="2" class="align-center">CHI PHÍ QUA KHO <br> THEO QUY ĐỊNH <br> CỦA TĐ</th>
              <th colSpan="2" class="align-center">GIÁ BÁN CHO PTC</th>
              <th rowSpan="2" class="align-center">GHI CHÚ</th>
            </tr>
            <tr>
              <th class="align-center">THEO LTT</th>
              <th class="align-center">THEO L15</th>
              <th class="align-center">L15 CHƯA THUẾ <br> VAT, CÓ BVMT</th>
              <th class="align-center">L15 CÓ THUẾ <br> VAT & BVMT</th>
            </tr>
          </thead>
          <tbody>
            @for (d of dlgTable_6.data; track d) {
            <tr>
              <td>{{d.colA}}</td>
              <td>{{d.colB}}</td>
              <td class="align-right">{{d.col1 | number}}</td>
              <td class="align-right">{{d.col2 | number}}</td>
              <td class="align-right">{{d.col3 | number}}</td>
              <td class="align-right">{{d.col4 | number}}</td>
              <td class="align-right">{{d.col5 | number}}</td>
              <td class="align-right">{{d.col6 | number}}</td>
              <td class="align-right">{{d.col7 | number}}</td>
              <td></td>
            </tr>
            }
          </tbody>
        </nz-table>

        <nz-divider nzText="THAY ĐỔI GIÁ BÁN LẺ" nzOrientation="left"></nz-divider>
        <div nz-row [nzGutter]="16">
          <div nz-col class="gutter-row" [nzSpan]="16">
            <div class="inner-box">
              <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #dlgTable_1
                [nzData]="data.dlg.dlg_1">
                <thead>
                  <tr>
                    <th class="align-center" rowspan="2">Mặt hàng</th>
                    <th class="align-center" colSpan="3">Thay đổi giá bán lẻ <br> (Tp Vinh, TX Cửa
                      Lò)</th>
                    <th class="align-center" colSpan="3">Thay đổi giá bán lẻ <br> (Vùng còn lại)
                    </th>
                  </tr>
                  <tr>
                    <th class="align-center">Giá cũ</th>
                    <th class="align-center">Giá mới</th>
                    <th class="align-center">Tăng/Giảm</th>
                    <th class="align-center">Giá cũ</th>
                    <th class="align-center">Giá mới</th>
                    <th class="align-center">Tăng/Giảm</th>
                  </tr>
                </thead>
                <!-- <tbody>
                                    @for (d of dlgTable_1.data; track d) {
                                    <tr>
                                        <td>{{d.col1}}</td>
                                        <td class="align-right">{{d.col2 | number}}</td>
                                        <td class="align-right">{{d.col3 | number}}</td>
                                        <td class="align-right">{{d.col4 | number}}</td>
                                        <td class="align-right">{{d.col5 | number}}</td>
                                        <td class="align-right">{{d.col6 | number}}</td>
                                        <td class="align-right">{{d.col7 | number}}</td>
                                        <td></td>
                                    </tr>
                                    }
                                </tbody> -->
              </nz-table>
            </div>
          </div>
          <div nz-col class="gutter-row" [nzSpan]="8">
            <div class="inner-box">
              <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #dlgTable_1
                [nzData]="data.dlg.dlg_1">
                <thead>
                  <tr>
                    <th class="align-center" rowspan="2">Mặt hàng</th>
                    <th class="align-center" colSpan="3">Thay đổi giá giao <br> phương thức bán lẻ
                    </th>
                  </tr>
                  <tr>
                    <th class="align-center">Giá cũ</th>
                    <th class="align-center">Giá mới</th>
                    <th class="align-center">Tăng/Giảm</th>
                  </tr>
                </thead>
                <!-- <tbody>
                                    @for (d of dlgTable_1.data; track d) {
                                    <tr>
                                        <td>{{d.col1}}</td>
                                        <td class="align-right">{{d.col2 | number}}</td>
                                        <td class="align-right">{{d.col3 | number}}</td>
                                        <td class="align-right">{{d.col4 | number}}</td>
                                        <td class="align-right">{{d.col5 | number}}</td>
                                        <td class="align-right">{{d.col6 | number}}</td>
                                        <td class="align-right">{{d.col7 | number}}</td>
                                        <td></td>
                                    </tr>
                                    }
                                </tbody> -->
              </nz-table>
            </div>
          </div>
        </div>


        <div nz-row [nzGutter]="16">
          <div nz-col class="gutter-row" [nzSpan]="12">
            <div class="inner-box">
              <nz-divider nzText="LÃI GỘP" nzOrientation="left"></nz-divider>
              <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #dlgTable_1
                [nzData]="data.dlg.dlg_1">
                <thead>
                  <tr>
                    <th class="align-center" rowspan="2">Mặt hàng</th>
                    <th class="align-center" colspan="3">So sánh lãi gộp giữa hai kỳ</th>
                  </tr>
                  <tr>
                    <th class="align-center">LG cũ</th>
                    <th class="align-center">LG mới</th>
                    <th class="align-center">Tăng/Giảm</th>
                  </tr>
                </thead>
                <!-- <tbody>
                                    @for (d of dlgTable_1.data; track d) {
                                    <tr>
                                        <td>{{d.col1}}</td>
                                        <td class="align-right">{{d.col2 | number}}</td>
                                        <td class="align-right">{{d.col3 | number}}</td>
                                        <td class="align-right">{{d.col4 | number}}</td>
                                        <td class="align-right">{{d.col5 | number}}</td>
                                        <td class="align-right">{{d.col6 | number}}</td>
                                        <td class="align-right">{{d.col7 | number}}</td>
                                        <td></td>
                                    </tr>
                                    }
                                </tbody> -->
              </nz-table>
            </div>
          </div>
          <div nz-col class="gutter-row" [nzSpan]="12">
            <div class="inner-box">
              <nz-divider nzText="ĐỀ XUẤT MỨC GIẢM GIÁ" nzOrientation="left"></nz-divider>
              <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #dlgTable_2
                [nzData]="data.dlg.dlg_2">
                <thead>
                  <tr>
                    <th class="align-center" rowspan="2">Mặt hàng</th>
                    <th class="align-center" colspan="3">So sánh chiết khấu giữa hai kỳ</th>
                  </tr>
                  <tr>
                    <th class="align-center">CK cũ</th>
                    <th class="align-center">CK mới</th>
                    <th class="align-center">Tăng/Giảm</th>
                  </tr>
                </thead>
                <!-- <tbody>
                                    @for (d of dlgTable_2.data; track d) {
                                    <tr>
                                        <td>{{d.col1}}</td>
                                        <td class="align-right">{{d.col2 | number}}</td>
                                    </tr>
                                    }
                                </tbody> -->
              </nz-table>
            </div>
          </div>
        </div>



      </div>

    </nz-tab>

    <nz-tab nzTitle="PT" (nzClick)="changeTitle('PT')">
      <div [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #ptTable
          [nzData]="data.pt">
          <thead>
            <tr>
              <th rowspan="4">STT</th>
              <th rowspan="4" class="align-center">Thị trường</th>
              <th rowspan="4" class="align-center">Cự ly <br> BQ (Km)</th>
              <th colspan="{{ data.lstGoods.length }}">Lãi gộp chưa VAT</th>
              <th colspan="3">Chi phí phát sinh chưa có VAT</th>
              <th colspan="2">CK điều tiết (-/+)</th>
              <th colspan="{{ data.lstGoods.length * 2 }}">Đề xuất mức giảm giá tại kho khách hàng</th>
              <th colspan="{{ data.lstGoods.length }}">Lợi nhuận chưa VAT</th>

              <th colspan="2" *ngFor="let item of data.lstGoods; let i = index">{{
                item.name }}</th>
            </tr>
            <tr>
              <th rowspan="2" *ngFor="let item of data.lstGoods; let i = index">{{
                item.name }}</th>
              <th rowspan="2">Tổng chi phí</th>
              <th rowspan="2" class="align-center">CP chung <br> chưa cước VC</th>
              <th rowspan="2" class="align-center">Cước VC <br> bình quân</th>

              <th rowspan="2">Xăng có VAT</th>
              <th rowspan="2">Dầu có VAT</th>

              <th colspan="2" *ngFor="let item of data.lstGoods; let i = index">{{
                item.name }}</th>

              <th rowspan="2" *ngFor="let item of data.lstGoods; let i = index">{{
                item.name }}</th>

              @for (i of data.lstGoods; track i){
              <th rowspan="2">Chưa VAT, BVMT</th>
              <th rowspan="2">Có VAT, BVMT</th>
              }

            </tr>
            <tr>
              @for (i of data.lstGoods; track i){
              <th rowspan="2">Có VAT</th>
              <th rowspan="2">Chưa VAT</th>
              }
            </tr>

          </thead>
          <tbody>
            @for (t of ptTable.data; track t) {
            <tr *ngIf="t.isBold == true" style="font-weight: bold;">
              <td>{{ t.colA }}</td>
              <td>{{ t.colB }}</td>
              <td class="align-right">{{ t.col1}}</td>
              @for (g of data.lstGoods; track g) {
              <td></td>
              }
              <td class="align-right">{{ t.col3 }}</td>
              <td class="align-right">{{ t.col4 }}</td>
              <td class="align-right">{{ t.col5 }}</td>
              <td></td>
              <td></td>
              @for (g of data.lstGoods; track g) {
              <td class="align-right"></td>
              <td class="align-right"></td>
              }
              @for (g of data.lstGoods; track g) {
              <td></td>
              }
              @for (g of data.lstGoods; track g) {
              <td class="align-right"></td>
              <td class="align-right"></td>
              }
            </tr>
            <tr *ngIf="t.isBold == false">
              <td>{{ t.colA }}</td>
              <td>{{ t.colB }}</td>
              <td class="align-right">{{ t.col1 | number}}</td>
              @for (l of t.lg; track l) {
              <td class="align-right">{{l | number}}</td>
              }
              <td class="align-right">{{ t.col3 | number}}</td>
              <td class="align-right">{{ t.col4 | number }}</td>
              <td class="align-right">{{ t.col5 | number }}</td>
              <td class="align-right"></td>
              <td class="align-right"></td>
              @for (l of t.gg; track l) {
              <td class="align-right">{{l.vat | number}}</td>
              <td class="align-right">{{l.nonVAT | number}}</td>
              }
              @for (l of t.ln; track l) {
              <td class="align-right">{{l | number}}</td>
              }
              @for (l of t.bvmt; track l) {
              <td class="align-right">{{l.nonVAT | number}}</td>
              <td class="align-right">{{l.vat | number}}</td>
              }

            </tr>
            }
          </tbody>

        </nz-table>
      </div>

    </nz-tab>

    <nz-tab nzTitle="ĐB" (nzClick)="changeTitle('ĐB')">
      <div [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #dbTable
          [nzData]="data.db">
          <thead>
            <tr>
              <th rowspan="3">STT</th>
              <th rowspan="3" class="align-center">KHÁCH HÀNG</th>
              <th rowspan="3" class="align-center">THỊ TRƯỜNG</th>
              <th rowspan="3" class="align-center">Cự ly <br> BQ (Km)</th>
              <th colspan="{{ data.lstGoods.length }}">Lãi gộp</th>
              <th colspan="4">Chi phí phát sinh chưa có VAT</th>
              <th rowspan="3" class="align-center">Hỗ trợ <br> cước v/c</th>
              <th rowspan="3" class="align-center">Hỗ trợ <br> theo <br> VB1370/PLX</th>
              <th rowspan="2" colspan="2" class="align-center">Mức giảm giá <br> linh hoạt <br> có VAT
                (-/+)</th>
              <th colspan="{{ data.lstGoods.length * 2 }}" class="align-center">Đề xuất mức giảm giá tại
                kho khách hàng</th>
              <th rowspan="3" class="align-center">CK Vòng 2 <br> đạt được <br> chưa VAT</th>
              <th colspan="{{ data.lstGoods.length }}">Lợi nhuận chưa VAT</th>

              <th colspan="2" *ngFor="let item of data.lstGoods; let i = index">{{
                item.name }}</th>
            </tr>
            <tr>
              @for (i of data.lstGoods; track i){
              <th rowspan="2" class="align-center">{{i.name}}</th>
              }
              <th rowspan="2" class="align-center">Tổng <br> chi phí</th>
              <th rowspan="2" class="align-center">CP chung <br> chưa <br> cước vc</th>
              <th rowspan="2" class="align-center">Cước VC <br> bình quân</th>
              <th rowspan="2" class="align-center">Lãi vay <br> NH (đ/l)</th>
              @for (i of data.lstGoods; track i){
              <th colspan="2" class="align-center">{{i.name}}</th>
              }
              @for (i of data.lstGoods; track i){
              <th rowspan="2" class="align-center">{{i.name}}</th>
              }
              @for (i of data.lstGoods; track i){
              <th rowspan="2">CHƯA VAT, BVMT</th>
              <th rowspan="2">CÓ VAT, BVMT</th>
              }
            </tr>
            <tr>
              <th class="align-center">Xăng</th>
              <th class="align-center">Dầu</th>
              @for (i of data.lstGoods; track i){
              <th>Có thuế</th>
              <th>Chưa thuế</th>
              }
            </tr>
          </thead>
          <tbody>
            @for (t of dbTable.data; track t) {
            <tr *ngIf="t.isBold == true" style="font-weight: bold;">
              <td>{{ t.colA }}</td>
              <td>{{ t.colB }}</td>
              <td></td>
              <td></td>
              @for (i of data.lstGoods; track i){
              <td></td>
              }
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              @for (i of data.lstGoods; track i){
              <td></td>
              <td></td>
              }
              <td></td>
              @for (i of data.lstGoods; track i){
              <td></td>
              }
              @for (i of data.lstGoods; track i){
              <td></td>
              <td></td>
              }
            </tr>
            <tr *ngIf="t.isBold == false">
              <td>{{ t.colA }}</td>
              <td>{{ t.colB }}</td>
              <td>{{ t.col1 }}</td>
              <td>{{ t.col2 }}</td>
              @for (i of t.lg; track i){
              <td class="align-right">{{i | number}}</td>
              }
              <td>{{ t.col3 }}</td>
              <td>{{ t.col4 }}</td>
              <td>{{ t.col5 }}</td>
              <td>{{ t.col6 }}</td>
              <td></td>
              <td></td>
              <td>{{ t.col9 }}</td>
              <td>{{ t.col10 }}</td>

              @for (i of t.gg; track i){
              <td class="align-right">{{i.vat | number}}</td>
              <td class="align-right">{{i.nonVAT | number}}</td>
              }
              <td></td>
              @for (i of t.ln; track i){
              <td class="align-right">{{i | number}}</td>
              }
              @for (i of t.bvmt; track i){
              <td class="align-right">{{i.nonVAT | number}}</td>
              <td class="align-right">{{i.vat | number}}</td>
              }
            </tr>
            }
          </tbody>

        </nz-table>
      </div>

    </nz-tab>

    <nz-tab nzTitle="FOB" (nzClick)="changeTitle('FOB')">
      <div [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #fobTable
          [nzData]="data.fob">
          <thead>
            <tr>
              <th rowspan="3">STT</th>
              <th rowspan="3" class="align-center">THỊ TRƯỜNG</th>
              <th colspan="{{ data.lstGoods.length }}">Lãi gộp</th>
              <th colspan="4">Chi phí phát sinh chưa có VAT</th>
              <th rowspan="3" class="align-center">Hỗ trợ <br> theo <br> VB1370/PLX</th>
              <th rowspan="2" colspan="2" class="align-center">Mức giảm giá <br> linh hoạt <br> có VAT
                (-/+)</th>
              <th colspan="{{ data.lstGoods.length * 2 }}" class="align-center">Đề xuất mức giảm giá </th>
              <th rowspan="3" class="align-center">CK Vòng 2 <br> đạt được <br> chưa VAT</th>
              <th colspan="{{ data.lstGoods.length }}">Lợi nhuận chưa VAT</th>
              <th colspan="2" *ngFor="let item of data.lstGoods; let i = index">{{
                item.name }}</th>
            </tr>
            <tr>
              @for (i of data.lstGoods; track i){
              <th rowspan="2" class="align-center">{{i.name}}</th>
              }
              <th rowspan="2" class="align-center">Tổng <br> chi phí</th>
              <th rowspan="2" class="align-center">CP chung <br> chưa <br> cước vc</th>
              <th rowspan="2" class="align-center">Cước VC <br> bình quân</th>
              <th rowspan="2" class="align-center">Lãi vay <br> NH (đ/l)</th>
              @for (i of data.lstGoods; track i){
              <th colspan="2" class="align-center">{{i.name}}</th>
              }
              @for (i of data.lstGoods; track i){
              <th rowspan="2" class="align-center">{{i.name}}</th>
              }
              @for (i of data.lstGoods; track i){
              <th rowspan="2">CHƯA VAT, BVMT</th>
              <th rowspan="2">CÓ VAT, BVMT</th>
              }
            </tr>
            <tr>
              <th class="align-center">Xăng</th>
              <th class="align-center">Dầu</th>
              @for (i of data.lstGoods; track i){
              <th>Có thuế</th>
              <th>Chưa thuế</th>
              }
            </tr>
          </thead>
          <tbody>
            @for (t of fobTable.data; track t) {
            <tr *ngIf="t.isBold == true" style="font-weight: bold;">
              <td>{{ t.colA }}</td>
              <td>{{ t.colB }}</td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              @for (i of data.lstGoods; track i){
              <td></td>
              <td></td>
              <td></td>
              <td></td>
              }
              @for (i of data.lstGoods; track i){
              <td></td>
              <td></td>
              }
            </tr>
            <tr *ngIf="t.isBold == false">
              <td>{{ t.colA }}</td>
              <td>{{ t.colB }}</td>

              @for (i of t.lg; track i){
              <td class="align-right">{{i | number}}</td>
              }
              <td>{{ t.col1 }}</td>
              <td>{{ t.col2 }}</td>
              <td>{{ t.col3 }}</td>
              <td>{{ t.col4 }}</td>
              <td>{{ t.col5 }}</td>
              <td>{{ t.col6 }}</td>
              <td>{{ t.col7 }}</td>
              @for (i of t.gg; track i){
              <td class="align-right">{{i.vat | number}}</td>
              <td class="align-right">{{i.nonVAT | number}}</td>
              }
              <td class="align-right">{{t.col8 | number}}</td>

              @for (i of t.ln; track i){
              <td class="align-right">{{i | number}}</td>
              }
              @for (i of t.bvmt; track i){
              <td class="align-right">{{i.nonVAT | number}}</td>
              <td class="align-right">{{i.vat | number}}</td>
              }
            </tr>
            }
          </tbody>

        </nz-table>
      </div>

    </nz-tab>

    <nz-tab nzTitle="PT09" (nzClick)="changeTitle('PT09')">

      <div [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #pt09Table
          [nzData]="data.pT09">
          <thead>
            <tr>
              <th rowspan="3">STT</th>
              <th rowspan="3" class="align-center">THỊ TRƯỜNG</th>
              <th colspan="{{ data.lstGoods.length }}">Lãi gộp được hưởng</th>
              <th colspan="4">Chi phí phát sinh chưa có VAT</th>
              <th rowspan="2" colspan="2" class="align-center">Mức giảm giá <br> linh hoạt <br> có VAT
                (-/+)</th>
              <th colspan="{{ data.lstGoods.length * 2 }}" class="align-center">Đề xuất mức giảm giá tại
                kho Công ty </th>
              <th rowspan="3" class="align-center">CK Vòng 2 <br> đạt được <br> chưa VAT</th>
              <th colspan="{{ data.lstGoods.length }}">Lợi nhuận chưa VAT</th>
              <th colspan="2" *ngFor="let item of data.lstGoods; let i = index">{{
                item.name }}</th>
            </tr>
            <tr>
              @for (i of data.lstGoods; track i){
              <th rowspan="2" class="align-center">{{i.name}}</th>
              }
              <th rowspan="2" class="align-center">Tổng <br> chi phí</th>
              <th rowspan="2" class="align-center">CP chung <br> chưa <br> cước vc</th>
              <th rowspan="2" class="align-center">Cước VC <br> bình quân</th>
              <th rowspan="2" class="align-center">Lãi vay <br> NH (đ/l)</th>
              @for (i of data.lstGoods; track i){
              <th colspan="2" class="align-center">{{i.name}}</th>
              }
              @for (i of data.lstGoods; track i){
              <th rowspan="2" class="align-center">{{i.name}}</th>
              }
              @for (i of data.lstGoods; track i){
              <th rowspan="2">CHƯA VAT, BVMT</th>
              <th rowspan="2">CÓ VAT, BVMT</th>
              }
            </tr>
            <tr>
              <th class="align-center">Xăng</th>
              <th class="align-center">Dầu</th>
              @for (i of data.lstGoods; track i){
              <th>Có thuế</th>
              <th>Chưa thuế</th>
              }
            </tr>
          </thead>
          <tbody>
            @for (t of pt09Table.data; track t) {
            <tr>
              <td>{{ t.colA }}</td>
              <td>{{ t.colB }}</td>
              @for (i of t.lg; track i){
              <td class="align-right">{{i | number}}</td>
              }
              <td class="align-right">{{ t.col3 }}</td>
              <td class="align-right">{{ t.col4 }}</td>
              <td class="align-right">{{ t.col5 }}</td>
              <td class="align-right">{{ t.col6 }}</td>
              <td class="align-right">{{ t.col7 }}</td>
              <td class="align-right">{{ t.col8 }}</td>
              @for (i of t.gg; track i){
              <td class="align-right">{{i.vat | number}}</td>
              <td class="align-right">{{i.nonVAT | number}}</td>
              }
              <td class="align-right">{{ t.col18 }}</td>
              @for (i of t.ln; track i){
              <td class="align-right">{{i | number}}</td>
              }
              @for (i of t.bvmt; track i){
              <td class="align-right">{{i.nonVAT | number}}</td>
              <td class="align-right">{{i.vat | number}}</td>
              }
            </tr>
            }
          </tbody>

        </nz-table>
      </div>

    </nz-tab>

    <nz-tab nzTitle="BB DO" (nzClick)="changeTitle('BB DO')">

      <div [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #bbdoTable
          [nzData]="data.bbdo">
          <thead>
            <tr>
              <th rowspan="2" class="align-center">STT</th>
              <th rowspan="2" class="align-center">Tên khách hàng</th>
              <th rowspan="2" class="align-center">Địa điểm giao hàng</th>
              <th rowspan="2" class="align-center">Mặt hàng</th>
              <th rowspan="2" class="align-center">PT</th>
              <th rowspan="2" class="align-center">Mã khách</th>
              <th rowspan="2" class="align-center">Mã hàng hóa</th>
              <th rowspan="2" class="align-center">ĐVT</th>
              <th rowspan="2" class="align-center">Thanh toán</th>
              <th colspan="2" class="align-center">Mức lãi gộp TĐ giao (vùng 2)</th>
              <th colspan="4" class="align-center">Chi phí tạm tính chưa VAT </th>
              <th colspan="2" class="align-center">Đề xuất mức giảm giá tại kho bên bán (FOB)</th>
              <th colspan="2" class="align-center">Mức giảm giá tại kho bên mua</th>
              <th colspan="2" class="align-center">LỢI NHUẬN (Đ/Ltt)</th>

              <th colspan="2" class="align-center">GIÁ BÁN CHO KHÁCH HÀNG (Đ/L)</th>
            </tr>
            <tr>
              <th class="align-center">Đã có thuế</th>
              <th class="align-center">Chưa thuế</th>
              <th class="align-center">Tổng chi phí</th>
              <th class="align-center">CP chung chưa cước vc</th>
              <th class="align-center">Cước vận chuyển</th>
              <th class="align-center">Lãi vay NH, phí bơm rót, ≠</th>
              <th class="align-center">Đã có thuế</th>
              <th class="align-center">Chưa thuế</th>
              <th class="align-center">Đã có thuế</th>
              <th class="align-center">Chưa thuế</th>
              <th class="align-center">Đã có thuế</th>
              <th class="align-center">Chưa thuế</th>
              <th class="align-center">CHƯA VAT, BVMT</th>
              <th class="align-center">CÓ VAT, BVMT</th>
            </tr>
          </thead>
          <tbody>
            @for (t of bbdoTable.data; track t) {
            <tr *ngIf="t.isBold" style="font-weight: bold;">
              <td></td>
              <td colspan="22">{{ t.colB }}</td>
            </tr>
            <tr *ngIf="!t.isBold">
              <td>{{ t.colA }}</td>
              <td>{{ t.colB }}</td>
              <td>{{ t.colC }}</td>
              <td>{{ t.colD }}</td>
              <td>{{ t.col1 }}</td>
              <td>{{ t.col2 }}</td>
              <td>{{ t.col3 }}</td>
              <td>{{ t.col4 }}</td>
              <td>{{ t.col5 }}</td>
              <td class="align-right">{{ t.col6 | number }}</td>
              <td class="align-right">{{ t.col7 | number}}</td>
              <td class="align-right">{{ t.col8 | number}}</td>
              <td class="align-right">{{ t.col9 | number}}</td>
              <td class="align-right">{{ t.col10 | number}}</td>
              <td class="align-right">{{ t.col11 | number}}</td>
              <td class="align-right">{{ t.col12 | number}}</td>
              <td class="align-right">{{ t.col13 | number}}</td>
              <td class="align-right">{{ t.col14 | number}}</td>
              <td class="align-right">{{ t.col15 | number}}</td>
              <td class="align-right">{{ t.col16 | number}}</td>
              <td class="align-right">{{ t.col17 | number}}</td>
              <td class="align-right">{{ t.col18 | number}}</td>
              <td class="align-right">{{ t.col19 | number}}</td>
            </tr>
            }
          </tbody>

        </nz-table>
      </div>

    </nz-tab>

    <nz-tab nzTitle="BB FO" (nzClick)="changeTitle('BB FO')">

      <div [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #bbfoTable
          [nzData]="data.bbfo">
          <thead>
            <tr>
              <th rowspan="2" class="align-center">STT</th>
              <th rowspan="2" class="align-center">Tên khách hàng / <br>Địa điểm giao hàng</th>
              <th rowspan="2" class="align-center">Mặt hàng</th>

              <th colspan="2" class="align-center">Mức lãi gộp TĐ giao (vùng 2)</th>
              <th colspan="4" class="align-center">Chi phí tạm tính</th>
              <th rowspan="2" class="align-center">Bù đắp cước <br> vận chuyển</th>
              <th rowspan="2" class="align-center">Lợi nhuận</th>

              <th colspan="2" class="align-center">GIÁ BÁN CHO KHÁCH HÀNG (đ/kg)</th>
            </tr>
            <tr>
              <th class="align-center">Có thuế</th>
              <th class="align-center">Chưa thuế</th>
              <th class="align-center">Tổng chi phí</th>
              <th class="align-center">CP chung <br> chưa cước vc</th>
              <th class="align-center">Cước vận tải</th>
              <th class="align-center">Lãi vay <br> NH (đ/l)</th>
              <th class="align-center">CHƯA VAT, BVMT</th>
              <th class="align-center">CÓ VAT, BVMT</th>
            </tr>
          </thead>
          <tbody>
            @for (t of bbfoTable.data; track t) {
            <tr *ngIf="t.isBold" style="font-weight: bold;">
              <td></td>
              <td colspan="12">{{ t.colB }}</td>
            </tr>
            <tr *ngIf="!t.isBold">
              <td>{{ t.colA }}</td>
              <td>{{ t.colB }}</td>
              <td>{{ t.colC }}</td>
              <td class="align-right">{{ t.col1 | number}}</td>
              <td class="align-right">{{ t.col2 | number}}</td>
              <td class="align-right">{{ t.col3 | number}}</td>
              <td class="align-right">{{ t.col4 | number}}</td>
              <td class="align-right">{{ t.col5 | number}}</td>
              <td class="align-right">{{ t.col6 | number}}</td>
              <td class="align-right">{{ t.col7 | number}}</td>
              <td class="align-right">{{ t.col8 | number}}</td>
              <td class="align-right">{{ t.col9 | number}}</td>
              <td class="align-right">{{ t.col10 | number}}</td>
            </tr>
            }
          </tbody>

        </nz-table>
      </div>

    </nz-tab>
    <nz-tab nzTitle="PL1" (nzClick)="changeTitle('PL1')">

      <div [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #pl1Table
          [nzData]="data.pL1">
          <thead>
            <tr>
              <th rowspan="3" class="align-center">STT</th>
              <th rowspan="3" class="align-center">VÙNG THỊ TRƯỜNG</th>
              <th colspan="{{ data.lstGoods.length}}" class="align-center">MỨC GIẢM GIÁ (Đã có VAT)</th>
            </tr>
            <tr>
              @for (i of data.lstGoods; track i){
              <th class="align-center">{{i.name}}</th>
              }
            </tr>
            <tr>
              @for (i of data.lstGoods; track i){
              <th class="align-center">đ/lít tt</th>
              }
            </tr>
          </thead>
          <tbody>
            @for (t of pl1Table.data; track t) {
            <tr>
              <td>{{ t.colA }}</td>
              <td>{{ t.colB }}</td>
              @for (i of t.gg; track i){
              <td class="align-right">{{i | number}}</td>
              }
            </tr>
            }
          </tbody>

        </nz-table>
      </div>

    </nz-tab>

    <nz-tab nzTitle="PL2" (nzClick)="changeTitle('PL2')">

      <div [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #pl2Table
          [nzData]="data.pL2">
          <thead>
            <tr>
              <th rowspan="3" class="align-center">STT</th>
              <th rowspan="3" class="align-center">VÙNG THỊ TRƯỜNG</th>
              <th colspan="{{ data.lstGoods.length}}" class="align-center">MỨC GIẢM GIÁ (Đã có VAT)</th>
            </tr>
            <tr>
              @for (i of data.lstGoods; track i){
              <th class="align-center">{{i.name}}</th>
              }
            </tr>
            <tr>
              @for (i of data.lstGoods; track i){
              <th class="align-center">đ/lít tt</th>
              }
            </tr>
          </thead>
          <tbody>
            @for (t of pl2Table.data; track t) {
            <tr>
              <td>{{ t.colA }}</td>
              <td>{{ t.colB }}</td>
              @for (i of t.gg; track i){
              <td class="align-right">{{i | number}}</td>
              }
            </tr>
            }
          </tbody>

        </nz-table>
      </div>

    </nz-tab>

    <nz-tab nzTitle="PL3" (nzClick)="changeTitle('PL3')">

      <div [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #pl3Table
          [nzData]="data.pL3">
          <thead>
            <tr>
              <th rowspan="3" class="align-center">STT</th>
              <th rowspan="3" class="align-center">VÙNG THỊ TRƯỜNG</th>
              <th colspan="{{ data.lstGoods.length}}" class="align-center">MỨC GIẢM GIÁ (Đã có VAT)</th>
            </tr>
            <tr>
              @for (i of data.lstGoods; track i){
              <th class="align-center">{{i.name}}</th>
              }
            </tr>
            <tr>
              @for (i of data.lstGoods; track i){
              <th class="align-center">đ/lít tt</th>
              }
            </tr>
          </thead>
          <tbody>
            @for (i of pl3Table.data; track i)
            {
            <tr>
              <td>{{ i.colA }}</td>
              <td>{{ i.colB }}</td>
              @for (g of i.gg; track g) {
              <td class="align-right">{{ g | number }}</td>
              }
            </tr>
            }
          </tbody>

        </nz-table>
      </div>

    </nz-tab>

    <nz-tab nzTitle="PL4" (nzClick)="changeTitle('PL4')">

      <div [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #pl4Table
          [nzData]="data.pL4">
          <thead>
            <tr>
              <th rowspan="3" class="align-center">STT</th>
              <th rowspan="3" class="align-center">VÙNG THỊ TRƯỜNG</th>
              <th colspan="{{ data.lstGoods.length}}" class="align-center">MỨC GIẢM GIÁ (Đã có VAT)</th>
            </tr>
            <tr>
              @for (i of data.lstGoods; track i){
              <th class="align-center">{{i.name}}</th>
              }
            </tr>
            <tr>
              @for (i of data.lstGoods; track i){
              <th class="align-center">đ/lít tt</th>
              }
            </tr>
          </thead>
          <tbody>
            @for (t of pl4Table.data; track t) {
            <tr>
              <td>{{ t.colA }}</td>
              <td>{{ t.colB }}</td>
              @for (i of t.gg; track i){
              <td class="align-right">{{i | number}}</td>
              }
            </tr>
            }
          </tbody>

        </nz-table>
      </div>
    </nz-tab>

    <nz-tab nzTitle="VK11 PT" (nzClick)="changeTitle('VK11 PT')">
      <div [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #vk11ptTable
          [nzData]="data.vK11PT">
          <thead>
            <tr>
              <th class="align-center">STT</th>
              <th class="align-center">Tên Khách hàng đại lý</th>
              <th class="align-center">Vùng CHXD</th>
              <th class="align-center">Cự ly <br> V/c km</th>
              <th class="align-center">Đơn giá <br> Cước đ/l</th>
              <th class="align-center">P thức</th>
              <th class="align-center">Mã khách</th>
              <th class="align-center">Mã hàng hoá</th>
              <th class="align-center">ĐVT</th>
              <th class="align-center">Thời hạn TT</th>
              <th class="align-center">Giá chưa <br> VAT&BVMT</th>
              <th class="align-center">Unit</th>
              <th class="align-center">Per</th>
              <th class="align-center">ĐVT</th>
              <th class="align-center">#</th>
              <th class="align-center">Hiệu lực từ</th>
              <th class="align-center">Thời gian</th>
              <th class="align-center">đến</th>
              <th class="align-center">Lower limit</th>
              <th class="align-center">Upper limit</th>
            </tr>

          </thead>
          <tbody>
            @for (t of vk11ptTable.data; track t) {
            <tr *ngIf="t.isBold" style="font-weight: bold;">
              <td></td>
              <td colspan="19">{{ t.colB }}</td>
            </tr>
            <tr *ngIf="!t.isBold">
              <td>{{ t.colA }}</td>
              <td>{{ t.colB }}</td>
              <td>{{ t.col1 }}</td>
              <td>{{ t.col2 }}</td>
              <td>{{ t.col3 }}</td>
              <td class="align-right">{{t.col4 | number }}</td>
              <td>{{ t.col5 }}</td>
              <td>{{ t.col6 }}</td>
              <td>{{ t.col7 }}</td>
              <td>{{ t.col8 }}</td>
              <td class="align-right">{{ t.col9 | number }}</td>
              <td>{{ t.col10 }}</td>
              <td>{{ t.col11 }}</td>
              <td>{{ t.col12 }}</td>
              <td>{{ t.col13 }}</td>
              <td>{{ t.col14 }}</td>
              <td>{{ t.col15 }}</td>
              <td>{{ t.col16 }}</td>
              <td>{{ t.col17 }}</td>
              <td>{{ t.col18 }}</td>
            </tr>
            }
          </tbody>

        </nz-table>
      </div>
    </nz-tab>

    <nz-tab nzTitle="VK11 ĐB" (nzClick)="changeTitle('VK11 ĐB')">
      <div [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #vk11dbTable
          [nzData]="data.vK11DB">
          <thead>
            <tr>
              <th class="align-center">STT</th>
              <th class="align-center">Địa chỉ</th>
              <th class="align-center">Tên Khách hàng đại lý</th>
              <th class="align-center">Vùng CHXD</th>
              <th class="align-center">Cự ly <br> V/c km</th>
              <th class="align-center">Đơn giá <br> Cước đ/l</th>
              <th class="align-center">P thức</th>
              <th class="align-center">Mã khách</th>
              <th class="align-center">Mã hàng hoá</th>
              <th class="align-center">ĐVT</th>
              <th class="align-center">Thời hạn TT</th>
              <th class="align-center">Giá chưa <br> VAT&BVMT</th>
              <th class="align-center">Unit</th>
              <th class="align-center">Per</th>
              <th class="align-center">ĐVT</th>
              <th class="align-center">#</th>
              <th class="align-center">Hiệu lực từ</th>
              <th class="align-center">Thời gian</th>
              <th class="align-center">đến</th>
              <th class="align-center">Lower limit</th>
              <th class="align-center">Upper limit</th>
            </tr>

          </thead>
          <tbody>
            @for (t of vk11dbTable.data; track t) {
            <tr *ngIf="t.isBold" style="font-weight: bold;">
              <td></td>
              <td colspan="20">{{ t.colB }}</td>
            </tr>
            <tr *ngIf="!t.isBold">
              <td>{{ t.colA }}</td>
              <td>{{ t.colB }}</td>
              <td>{{ t.colC }}</td>
              <td>{{ t.col1 }}</td>
              <td>{{ t.col2 }}</td>
              <td>{{ t.col3 }}</td>
              <td class="align-right">{{t.col4 | number }}</td>
              <td>{{ t.col5 }}</td>
              <td>{{ t.col6 }}</td>
              <td>{{ t.col7 }}</td>
              <td>{{ t.col8 }}</td>
              <td class="align-right">{{ t.col9 | number }}</td>
              <td>{{ t.col10 }}</td>
              <td>{{ t.col11 }}</td>
              <td>{{ t.col12 }}</td>
              <td>{{ t.col13 }}</td>
              <td>{{ t.col14 }}</td>
              <td>{{ t.col15 }}</td>
              <td>{{ t.col16 }}</td>
              <td>{{ t.col17 }}</td>
              <td>{{ t.col18 }}</td>
            </tr>
            }
          </tbody>

        </nz-table>
      </div>
    </nz-tab>

    <nz-tab nzTitle="VK11-FOB" (nzClick)="changeTitle('VK11-FOB')">
      <div [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #vk11fobTable
          [nzData]="data.vK11FOB">
          <thead>
            <tr>
              <th class="align-center">STT</th>
              <th class="align-center">Tên Khách hàng đại lý</th>
              <th class="align-center">Vùng CHXD</th>
              <th class="align-center">Cự ly <br> V/c km</th>
              <th class="align-center">Đơn giá <br> Cước đ/l</th>
              <th class="align-center">P thức</th>
              <th class="align-center">Mã khách</th>
              <th class="align-center">Mã hàng hoá</th>
              <th class="align-center">ĐVT</th>
              <th class="align-center">Thời hạn TT</th>
              <th class="align-center">Giá chưa <br> VAT&BVMT</th>
              <th class="align-center">Unit</th>
              <th class="align-center">Per</th>
              <th class="align-center">ĐVT</th>
              <th class="align-center">#</th>
              <th class="align-center">Hiệu lực từ</th>
              <th class="align-center">Thời gian</th>
              <th class="align-center">đến</th>
              <th class="align-center">Lower limit</th>
              <th class="align-center">Upper limit</th>
            </tr>

          </thead>
          <tbody>
            @for (t of vk11fobTable.data; track t) {
            <tr *ngIf="t.isBold" style="font-weight: bold;">
              <td></td>
              <td colspan="19">{{ t.colB }}</td>
            </tr>
            <tr *ngIf="!t.isBold">
              <td>{{ t.colA }}</td>
              <td>{{ t.colC }}</td>
              <td>{{ t.col1 }}</td>
              <td>{{ t.col2 }}</td>
              <td>{{ t.col3 }}</td>
              <td class="align-right">{{t.col4 | number }}</td>
              <td>{{ t.col5 }}</td>
              <td>{{ t.col6 }}</td>
              <td>{{ t.col7 }}</td>
              <td>{{ t.col8 }}</td>
              <td class="align-right">{{ t.col9 | number }}</td>
              <td>{{ t.col10 }}</td>
              <td>{{ t.col11 }}</td>
              <td>{{ t.col12 }}</td>
              <td>{{ t.col13 }}</td>
              <td>{{ t.col14 }}</td>
              <td>{{ t.col15 }}</td>
              <td>{{ t.col16 }}</td>
              <td>{{ t.col17 }}</td>
              <td>{{ t.col18 }}</td>
            </tr>
            }
          </tbody>

        </nz-table>
      </div>
    </nz-tab>

    <nz-tab nzTitle="VK11-TNPP" (nzClick)="changeTitle('VK11-TNPP')">
      <div [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #vk11tnppTable
          [nzData]="data.vK11TNPP">
          <thead>
            <tr>
              <th class="align-center">STT</th>
              <th class="align-center">Tên Khách hàng đại lý</th>
              <th class="align-center">Vùng CHXD</th>
              <th class="align-center">Cự ly <br> V/c km</th>
              <th class="align-center">Đơn giá <br> Cước đ/l</th>
              <th class="align-center">P thức</th>
              <th class="align-center">Mã khách</th>
              <th class="align-center">Mã hàng hoá</th>
              <th class="align-center">ĐVT</th>
              <th class="align-center">Thời hạn TT</th>
              <th class="align-center">Giá chưa <br> VAT&BVMT</th>
              <th class="align-center">Unit</th>
              <th class="align-center">Per</th>
              <th class="align-center">ĐVT</th>
              <th class="align-center">#</th>
              <th class="align-center">Hiệu lực từ</th>
              <th class="align-center">Thời gian</th>
              <th class="align-center">đến</th>
              <th class="align-center">Lower limit</th>
              <th class="align-center">Upper limit</th>
            </tr>

          </thead>
          <tbody>
            @for (t of vk11tnppTable.data; track t) {
            <tr *ngIf="t.isBold" style="font-weight: bold;">
              <td></td>
              <td colspan="19">{{ t.colB }}</td>
            </tr>
            <tr *ngIf="!t.isBold">
              <td>{{ t.colA }}</td>
              <td>{{ t.colC }}</td>
              <td>{{ t.col1 }}</td>
              <td>{{ t.col2 }}</td>
              <td>{{ t.col3 }}</td>
              <td class="align-right">{{t.col4 | number }}</td>
              <td>{{ t.col5 }}</td>
              <td>{{ t.col6 }}</td>
              <td>{{ t.col7 }}</td>
              <td>{{ t.col8 }}</td>
              <td class="align-right">{{ t.col9 | number }}</td>
              <td>{{ t.col10 }}</td>
              <td>{{ t.col11 }}</td>
              <td>{{ t.col12 }}</td>
              <td>{{ t.col13 }}</td>
              <td>{{ t.col14 }}</td>
              <td>{{ t.col15 }}</td>
              <td>{{ t.col16 }}</td>
              <td>{{ t.col17 }}</td>
              <td>{{ t.col18 }}</td>
            </tr>
            }
          </tbody>

        </nz-table>
      </div>
    </nz-tab>

    <nz-tab nzTitle="PTS" (nzClick)="changeTitle('PTS')">

    </nz-tab>

    <nz-tab nzTitle="VK11 BB" (nzClick)="changeTitle('VK11 BB')">
      <div [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #vk11bbTable
          [nzData]="data.vK11BB">
          <thead>
            <tr>
              <th class="align-center">STT</th>
              <th class="align-center">Tên Khách hàng đại lý</th>
              <th class="align-center">Địa điểm giao hàng</th>
              <th class="align-center">Mặt hàng</th>
              <th class="align-center">Phương thức</th>
              <th class="align-center">Mã khách hàng</th>
              <th class="align-center">Mã hàng hoá</th>
              <th class="align-center">ĐVT</th>
              <th class="align-center">Thời hạn TT</th>
              <th class="align-center">Giá chưa <br> VAT&BVMT</th>
              <th class="align-center">Unit</th>
              <th class="align-center">Per</th>
              <th class="align-center">ĐVT</th>
              <th class="align-center">#</th>
              <th class="align-center">Hiệu lực từ</th>
              <th class="align-center">Thời gian</th>
              <th class="align-center">đến</th>
              <th class="align-center">Lower limit</th>
              <th class="align-center">Upper limit</th>
            </tr>

          </thead>
          <tbody>
            @for (t of vk11bbTable.data; track t) {
            <tr *ngIf="t.isBold" style="font-weight: bold;">
              <td></td>
              <td colspan="18">{{ t.colB }}</td>
            </tr>
            <tr *ngIf="!t.isBold">
              <td>{{ t.colA }}</td>
              <td>{{ t.colB }}</td>
              <td>{{ t.colC }}</td>
              <td>{{ t.colD }}</td>
              <td>{{ t.col1 }}</td>
              <td>{{ t.col2 }}</td>
              <td>{{ t.col3 }}</td>
              <td>{{ t.col4 }}</td>
              <td>{{ t.col5 }}</td>
              <td class="align-right">{{t.col6 | number }}</td>
              <td>{{ t.col7 }}</td>
              <td>{{ t.col8 }}</td>
              <td>{{ t.col9 }}</td>
              <td>{{ t.col10 }}</td>
              <td>{{ t.col11 }}</td>
              <td>{{ t.col12 }}</td>
              <td>{{ t.col13 }}</td>
              <td>{{ t.col14 }}</td>
              <td>{{ t.col15 }}</td>
            </tr>
            }
          </tbody>

        </nz-table>
      </div>

    </nz-tab>

    <nz-tab nzTitle="Tổng hợp" (nzClick)="changeTitle('TỔNG HỢP')">
      <div [ngStyle]="{
        'overflow': 'auto',
        'height': isZoom ? '100vh' : 'calc(100vh - 206px)'
      }">
        <nz-table [nzShowPagination]="false" nzSize="small" [nzFrontPagination]="false" nzBordered #summaryTable
          [nzData]="data.summary">
          <thead>
            <tr>
              <th class="align-center">STT</th>
              <th class="align-center">Tên Khách hàng đại lý</th>
              <th class="align-center">Địa điểm giao hàng</th>
              <th class="align-center">Mặt hàng</th>
              <th class="align-center">Phương thức</th>
              <th class="align-center">Mã khách hàng</th>
              <th class="align-center">Mã hàng hoá</th>
              <th class="align-center">ĐVT</th>
              <th class="align-center">Thời hạn TT</th>
              <th class="align-center">Giá chưa <br> VAT&BVMT</th>
              <th class="align-center">Unit</th>
              <th class="align-center">Per</th>
              <th class="align-center">ĐVT</th>
              <th class="align-center">#</th>
              <th class="align-center">Hiệu lực từ</th>
              <th class="align-center">Thời gian</th>
              <th class="align-center">đến</th>
              <th class="align-center">Lower limit</th>
              <th class="align-center">Upper limit</th>
            </tr>

          </thead>
          <tbody>
            @for (t of summaryTable.data; track t) {
            <tr *ngIf="t.isBold" style="font-weight: bold;">
              <td></td>
              <td colspan="18">{{ t.colB }}</td>
            </tr>
            <tr *ngIf="!t.isBold">
              <td>{{ t.colA }}</td>
              <td>{{ t.colB }}</td>
              <td>{{ t.colC }}</td>
              <td>{{ t.colD }}</td>
              <td>{{ t.col1 }}</td>
              <td>{{ t.col2 }}</td>
              <td>{{ t.col3 }}</td>
              <td>{{ t.col4 }}</td>
              <td>{{ t.col5 }}</td>
              <td class="align-right">{{t.col6 | number }}</td>
              <td>{{ t.col7 }}</td>
              <td>{{ t.col8 }}</td>
              <td>{{ t.col9 }}</td>
              <td>{{ t.col10 }}</td>
              <td>{{ t.col11 }}</td>
              <td>{{ t.col12 }}</td>
              <td>{{ t.col13 }}</td>
              <td>{{ t.col14 }}</td>
              <td>{{ t.col15 }}</td>
            </tr>
            }
          </tbody>

        </nz-table>
      </div>
    </nz-tab>
  </nz-tabset>
</div>

</div>

<!-- Customer -->
<nz-modal [(nzVisible)]="isVisibleCustomer" nzTitle="CHỌN KHÁCH HÀNG" (nzOnCancel)="handleCancel()"
  (nzOnOk)="confirmExportWord()" nzCancelText="Đóng">
  <ng-container *nzModalContent>
    <nz-table #customerTable [nzData]="lstCustomer" nzSize="small">
      <thead>
        <tr>
          <th [(nzChecked)]="checked" (nzCheckedChange)="onAllChecked($event)"></th>
          <th>Tên khách hàng</th>
        </tr>
      </thead>
      <tbody>
        @for (data of customerTable.data; track data) {
        <tr>
          <td [nzChecked]="lstCustomerChecked.includes(data.code)" (nzCheckedChange)="onItemChecked(data.code, $event)">
          </td>
          <td>{{ data.name }}</td>
        </tr>
        }
      </tbody>
    </nz-table>
  </ng-container>
</nz-modal>

<!-- Customer PDF -->
<nz-modal [(nzVisible)]="isVisibleCustomerPDF" nzTitle="CHỌN KHÁCH HÀNG" (nzOnCancel)="handleCancel()"
  (nzOnOk)="confirmExportPDF()" nzCancelText="Đóng">
  <ng-container *nzModalContent>
    <nz-table #customerTable [nzData]="lstCustomer" nzSize="small">
      <thead>
        <tr>
          <th [(nzChecked)]="checked" (nzCheckedChange)="onAllChecked($event)"></th>
          <th>Tên khách hàng</th>
        </tr>
      </thead>
      <tbody>
        @for (data of customerTable.data; track data) {
        <tr>
          <td [nzChecked]="lstCustomerChecked.includes(data.code)" (nzCheckedChange)="onItemChecked(data.code, $event)">
          </td>
          <td>{{ data.name }}</td>
        </tr>
        }
      </tbody>
    </nz-table>
  </ng-container>
</nz-modal>

<!-- History -->
<nz-modal nzWidth="60%" [(nzVisible)]="isVisibleHistory" nzTitle="LỊCH SỬ THỰC HIỆN" (nzOnCancel)="handleCancel()"
  nzCancelText="Đóng">
  <ng-container *nzModalContent>
    <nz-table #historyTable [nzData]="lstHistory" nzSize="small">
      <thead>
        <tr>
          <th>Hành động</th>
          <th>Người cập nhật</th>
          <th>Thời gian cập nhật</th>
          <th>Nội dung</th>
        </tr>
      </thead>
      <tbody>
        @for (data of historyTable.data; track data) {
          <tr>
            <td>{{data.action}}</td>
            <td class="align-center">{{data.createBy}}</td>
            <td class="align-center">{{data.createDate | date:'dd/MM/yyyy hh:mm:ss'}}</td>
            <td>{{data.contents}}</td>
          </tr>
          }
      </tbody>
    </nz-table>
  </ng-container>
</nz-modal>

<!-- History Export File-->
<nz-modal nzWidth="60%" [(nzVisible)]="isVisibleExport" nzTitle="LỊCH SỬ XUẤT FILE" (nzOnCancel)="handleCancel()"
  nzCancelText="Đóng">
  <ng-container *nzModalContent>
    <nz-table #historyTableFile [nzData]="lstHistoryFile" nzSize="small">
      <thead>
        <tr>
          <th></th>
          <th class="align-center">Tên file</th>
          <th class="align-center">Người xuất</th>
          <th class="align-center">Thời gian</th>
          <th class="align-center">Hành động</th>
        </tr>
      </thead>
      <tbody>
        @for (data of historyTableFile.data; track data) {
          <tr>
            <td *ngIf="data.type == 'xlsx'">
              <img src="/assets/img/excel.png" style="width: 24px;">
            </td>
            <td *ngIf="data.type == 'docx'">
              <img src="/assets/img/word.png" style="width: 24px;">
            </td>
            <td *ngIf="data.type == 'pdf'">
              <img src="/assets/img/pdf.png" style="width: 24px;">
            </td>
            <td>{{data.name}}</td>
            <td class="align-center">{{data.createBy}}</td>
            <td class="align-center">{{data.createDate | date:'dd/MM/yyyy hh:mm:ss'}}</td>
            <td class="align-center">
              <button nz-button nzType="default" (click)="openNewTab(data.pathView)"><span nz-icon nzType="eye"></span>Xem trực tiếp</button>
              <button nz-button nzType="default" (click)="openNewTab(data.pathDownload)" style="margin-left: 12px;"><span nz-icon nzType="download"></span>Tải xuống</button>
            </td>
          </tr>
          }
      </tbody>
    </nz-table>
  </ng-container>
</nz-modal>

<!-- Dữ liệu gốc -->
<nz-drawer [nzWidth]="'60%'" [nzVisible]="visibleDrawer" nzPlacement="right" [nzTitle]="'DỮ LIỆU ĐẦU VÀO (DỮ LIỆU GỐC)'"
  [nzExtra]="extra" (nzOnClose)="closeDrawer()">
  <ng-container *nzDrawerContent>

    <nz-divider nzText="THÔNG TIN" nzOrientation="left"></nz-divider>
    <div nz-row [nzGutter]="{ xs: 8, sm: 16, md: 24, lg: 32 }">
      <div nz-col class="gutter-row" [nzSpan]="18">
        <div class="inner-box">
          <label>Tên đợt nhập</label>
          <input nz-input [(ngModel)]="model.header.name" />
        </div>
      </div>
      <div nz-col class="gutter-row" [nzSpan]="6">
        <div class="inner-box">
          <label>Ngày hiệu lực</label>
          <nz-date-picker nzShowTime nzFormat="dd-MM-yyyy HH:mm:ss" [(ngModel)]="model.header.fDate"></nz-date-picker>
        </div>
      </div>
    </div>
    <nz-divider nzText="HỆ SỐ MẶT HÀNG" nzOrientation="left"></nz-divider>

    <nz-table #hs2Table [nzData]="model.hS2" nzSize="small">
      <thead>
        <tr>
          <th rowspan="2" [nzAlign]="'center'">Mặt hàng</th>
          <th rowspan="2" [nzAlign]="'center'">Giá bán lẻ CS <br>(giá V1 TĐ công bố)</th>
          <th rowspan="2" [nzAlign]="'center'">Giá bán lẻ V2<br>(TĐ công bố)</th>
          <th rowspan="2" [nzAlign]="'center'">Chênh lệch giá<br>V2-V1</th>
          <th colspan="2" [nzAlign]="'center'">Đề xuất giá bán lẻ vùng trung tâm</th>
          <th rowspan="2" [nzAlign]="'center'">Chênh lệch giá bán lẻ <br>vùng Trung tâm và còn lại</th>
        </tr>
        <tr>
          <th>Mức Tăng so V1</th>
          <th>Giá niêm yết</th>
        </tr>
      </thead>
      <tbody>
        @for (data of hs2Table.data; track data) {
        <tr>
          <td style="width: 20%;">
            <nz-select nzShowSearch nzAllowClear placeholder="Chọn mặt hàng" [(ngModel)]="data.goodsCode"
              [nzDisabled]="true" style="width: 100%;">
              <nz-option cdkScrollable *ngFor="let item of goodsResult" [nzLabel]="item.name" [nzValue]="item.code">
              </nz-option>
            </nz-select>
          </td>
          <td>
            <input class="input-v" nz-input [(ngModel)]="data.gblcsV1" type="number" (keyup)="onKeyUpCalculate(data)" />
          </td>
          <td>
            <input class="input-v" nz-input [(ngModel)]="data.gblV2" type="number" (keyup)="onKeyUpCalculate(data)" />
          </td>
          <td>
            <input class="input-v" nz-input [(ngModel)]="data.v2_V1" type="number" />
          </td>
          <td>
            <input class="input-v" nz-input [(ngModel)]="data.mtsV1" type="number" (keyup)="onKeyUpCalculate(data)" />
          </td>
          <td>
            <input class="input-v" nz-input [(ngModel)]="data.gny" type="number" />
          </td>
          <td>
            <input class="input-v" nz-input [(ngModel)]="data.clgblv" type="number" />
          </td>
        </tr>
        }
      </tbody>
    </nz-table>



    <nz-table #hs1Table [nzData]="model.hS1" nzSize="small">
      <thead>
        <tr>
          <th [nzAlign]="'center'">Mặt hàng</th>
          <th [nzAlign]="'center'">Hệ số VFC BQ mùa miền</th>
          <th [nzAlign]="'center'">Thuế BVMT</th>
          <th [nzAlign]="'center'">L15 chưa VAT và BVMT <br> (PT bán lẻ - V2)</th>
          <th [nzAlign]="'center'">L15 chưa VAT và BVMT <br> (ngoài bán lẻ)</th>
          <th [nzAlign]="'center'">Giảm giá FOB <br> có VAT & BVMT</th>
        </tr>
      </thead>
      <tbody>
        @for (data of hs1Table.data; track data) {
        <tr>
          <td style="width: 20%;">
            <nz-select nzShowSearch nzAllowClear placeholder="Chọn mặt hàng" [(ngModel)]="data.goodsCode"
              [nzDisabled]="true" style="width: 100%;">
              <nz-option cdkScrollable *ngFor="let item of goodsResult" [nzLabel]="item.name" [nzValue]="item.code">
              </nz-option>
            </nz-select>
          </td>
          <td>
            <input class="input-v" nz-input [(ngModel)]="data.heSoVcf" type="number" />
          </td>
          <td>
            <input class="input-v" nz-input [(ngModel)]="data.thueBvmt" type="number" />
          </td>
          <td>
            <input class="input-v" nz-input [(ngModel)]="data.l15ChuaVatBvmt" type="number" />
          </td>
          <td>
            <input class="input-v" nz-input [(ngModel)]="data.l15ChuaVatBvmtNbl" type="number" />
          </td>
          <td>
            <input class="input-v" nz-input [(ngModel)]="data.giamGiaFob" type="number" />
          </td>
        </tr>
        }
      </tbody>
    </nz-table>
  </ng-container>
</nz-drawer>

<ng-template #extra>
  <button nz-button nzType="primary" (click)="updateDataInput()">Cập nhật</button>
</ng-template>

<!-- Thay đổi trạng thái -->
<nz-modal [(nzVisible)]="isVisibleStatus" [nzTitle]="statusModel.title" (nzOnCancel)="handleCancel()"
  (nzOnOk)="handleOkStatus()" nzCancelText="Huỷ">
  <ng-container *nzModalContent>
    <p>{{statusModel.des}}</p>
    <textarea nz-input placeholder="Nội dung, ý kiến..." [nzAutosize]="{ minRows: 2, maxRows: 6 }"
      [(ngModel)]="statusModel.value"></textarea>
  </ng-container>
</nz-modal>
